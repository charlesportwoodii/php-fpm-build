# docker-compose.yml

version: '3'
services:
    trusty: 
        image: charlesportwoodii/ubuntu:14.04-build
        container_name: trusty_x64
        command: bash -lc "make build fpm_debian VERSION=$VERSION RELEASEVER=$RELEASEVER"
        volumes: 
            - ${PWD-.}:/data
        working_dir: /data
        environment:
            - VERSION=$VERSION
            - RELEASEVER=$RELEASEVER
    xenial:
        image: charlesportwoodii/ubuntu:16.04-build
        container_name: xenial_x64
        command: bash -lc "make build fpm_debian VERSION=$VERSION RELEASEVER=$RELEASEVER"
        volumes: 
            - ${PWD-.}:/data
        working_dir: /data
        environment:
            - VERSION=$VERSION
            - RELEASEVER=$RELEASEVER
    centos7:
        image: charlesportwoodii/centos:7-build
        container_name: centos7_x86_64
        command: bash -lc "make build fpm_rpm VERSION=$VERSION RELEASEVER=$RELEASEVER"
        volumes: 
            - ${PWD-.}:/data
        working_dir: /data
        environment:
            - VERSION=$VERSION
            - RELEASEVER=$RELEASEVER
    rhel7:
        image: charlesportwoodii/rhel:7-build
        container_name: rhel7_x86_64
        command: bash -lc "make build fpm_rpm VERSION=$VERSION RELEASEVER=$RELEASEVER"
        volumes: 
            - ${PWD-.}:/data
        working_dir: /data
        environment:
            - VERSION=$VERSION
            - RELEASEVER=$RELEASEVER
    alpine3.6:
        image: charlesportwoodii/alpine:3.6-build
        container_name: alpine36_x86_64
        command: bash -lc "make build fpm_alpine VERSION=$VERSION RELEASEVER=$RELEASEVER"
        volumes: 
            - ${PWD-.}:/data
        working_dir: /data
        environment:
            - VERSION=$VERSION
            - RELEASEVER=$RELEASEVER
    alpine3.7:
        image: charlesportwoodii/alpine:3.7-build
        container_name: alpine36_x86_64
        command: sh -lc "" #apk del apr-dev apr-util-dev apache2-dev bash-completion bash libtool; sed -i '1 s/^.*$/SHELL := /bin/sh' Makefile; CORES=1 VERSION=$VERSION RELEASEVER=$RELEASEVER make openssl curl libargon2 libsodium php fpm_alpine "
        volumes: 
            - ${PWD-.}:/data
        working_dir: /data
        environment:
            - VERSION=$VERSION
            - RELEASEVER=$RELEASEVER
